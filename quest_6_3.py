mentors = """aaCcaCCCCccbbBcbBcCaAacaCCACbaCCbcbCBCaccaabcAcCBCbcBcbccbAacCcAAbcabCbbBCCABCccAACCaCAabbbcBcBaccACBcbaaCCaAbbAbAACbbbcCBCcCaBCbbaAccccCcABabaaCbCBBAacCBCAbCBAAbCcbBCBBCBCCBCAbcbBabaCaaCACCACbCCcbAaaCbAcbbBcbbacCAaaCbBABCCccbcbcCaBBbBAbBCCAcCCACaBcCaBaABaaaBCAAaCBabcaabAacCcacccbABBbacBBcBBBACbbBcAbBCBccaaBabCCaCCBACBABbBCabBcaCCccbcaCcabcBaaABaaACBCabaabCbcccaBAaBabBACBcbcacbACabBCAbaABAbAaBAbcbbcbcacaaBbbBbCaaBCBBCcAbcbccBbACAABbBaAaABcaBbBCBbaCaABCaaBabbBbCcBcAaCCBAAccCbAbBBcACcaABABBcbAcCbAbCAACabAacabaCaaCaCBbaCcacAbbaccbbAbBCacACbcCAabbBbCAbbCCAAaCaCcBcbabaABBCBbcBCbacCCaaAaCAaAbcbaBACCCabaabCcbCAbAAcCccaCAbCabCcbacAbbcABCBBBAABbCCCabCcAbaabAbBAaCCcBbAbCcbBBcCCcaaABbCAcACaaBAaABAcAcbcBBaAbCBCbaacacCccAcCcAcCACbaAaCbAbbcCCbcCCbCAAAbABABAAbcaCaaABCbaaAabAAAcAAcBCbccAAbACaBCCcaCaBcbbCccaAABcaccbCAcCBCBbaaccCccbABcaAcCCBCBBAAABBCbBCBBaAccCcacCAcbbccAbbbaBcABCaaaACBcaaBBACaACBBaBcAcAbBCccccacAbccBbBAbabbbBBccAAcBCbcBAaCbbBAcBBcbAbbCbCBBbaBaacbbaCacacBCBBACAccAabbccBaccbaBCCaCBCCCBABAbbABCAbababCCABBCCacccaaBBBabcBaaAabCaaccccCABCbacAcbCAaCcABBCbaCBAAcAAcaAAAabacCbbAcBbcBCbAabBCbcBACBCcaBAcCAAaacbCbaBAcbcAccbaCBAaCbBbccbBbcacacBAbCaAbAbcbBcCaBaBBbABbcCbbBcccCbBbCccCacBcBcaBBaBaaccCbCAaCBaACAACbaBABCAabBbBCbCAcbBAACacBbaaAaCBBaBacCbCCBBaCAbcBcBaCCBabAaaABcacbACabbbbbbabaabBccBcbbCBAbCAaAcAAaCaaaaBBbaccCABBCccCacaaBCccAccBbCaCaaAAbccbcAaccBBBcAACacaBCaBBCBBAcCCbAbACbCacbaCAAAcCbBaCBCBCabACBCAaCaacbAacbbcaABCCaBBbcCbbbCCCCcAcABCCAcbbBccAAaBcaCbbBCAcaCcaAaacaaBBccBBbBBAbCccBccBbbACbCABbaaBbbBbCbcBcccBbBcCbcAAABacaAACcBCBbAbaCaAbaBaAaaABAACbaAaAbCccaabaBAAbCcCcbBcaaCAcbBcAcABbcacCCAAABBAbBCaaBCBacBCbAACBaCACCbbbaabbcabbabAbcaBaCccbaaaBbbabBaAaaAcAAaBAcAbACaaaCBCaBABbaaAaACbcBABAbccAccaAAbabCCBcAbbBBabbBAACABBccACbAcACBCABCaAbBAcBAaAACAcbbCbABbAABACbbacCBcAbBBCAABbbaAaBacbacacacBBbbACCAcbabBcaaCBcbCCbCACCBccBcAbAcAaBCcCaAbABacBCBBCbcBcbBAAAcCBbBCcbACCaaCcabCbCCAbBcCbBBbaccbcCaACAabAccbBAbcBABbbBCAaAcbAAaccCBaBBBAAbbCBaACBACBCCcABbbaaAAcaCABcCcBCcccCcACaacaCbaccbaCBbbAAbCacaacbaBAaCBbabcaaAAbBCCcccBaBabBAABbBabaacAbAacaacABCCBcBCCbCBcACBCAACBAAacBAbacACacABaCaAAAbCcbBbaBcBAcbACABabCabCCbcAaaBBabCABcBccCcAcCaaACAcAAbbacacacAacbaCACaCccaccbCBccCcBccCAcABcCAcAcaaBaCbCAAbbAbBbcccCCCCACCBAaCBccbbaAcbaBaaACABbCcbACcaBBcAaaaAAAABAbCCbbcbCcCBbaAaabCabbcAbAcbBbcaBbaBAbBCaaBbAAcBBAabCCBCbAaBaCcccBaAabBCbBccaBAACcbaaCBACcABccCBcBbBCbbBBabcbCcaccAAcbCcBBabCcBaCbbaBBBACBbbcabaacBBbCBAaBBBCCbcBbcCABcCAbBBAcABcBAaacBAbcAcCaaBcBaACBcBaCaAAaaacCaCbAcbCaBCCCaaCaBACAcaaAbBCCCBAbCcBabBBcBaAAabbbaBBbBBCcAbABBbCcAbBccbCCABBACacccBcAAbbBbCAABBcBABcaaBBbaCAACABBbacabaBabBAAbAaBBccabaBCcBAcbbabACCABacAbcACaabbcCaAabBabbBAaCCAbacCCbBBbaCBcBAACBBACaCAacAABABcBaACBBcBBacACBBbBbcbbBbcCbAcACABcCAbAAbACaCABACBaaABabcbCCCBCcbbaacBbCccaccaAbAABbBCcaacAbCaCACCBacBABCbBABBBCCcBCbcBaabCCcbbABbCCACAbcAaCABAbbBACcBacaCBAbCAaBbAaBAaCCBBBaCBcCBBbACBbbBBAcBCbCBAbaabCcBACcCcbCBaABCAbABacBBCCBAaABbBbAcAbCAaAACCaBCAccaAcCbBCcBAaBAcaAbcCbcAaCCACBCcbBAbbACbaAcCCBcBBBAAAAbcaccCAcACCBbaaBACccAAcABbBaabbBbcCBCaACAcbacCBbbBaAaaAcabcAcBaBaCCaccacBbbaBAbbcCBACCCcaCcbbcBCACAacCabAaBbCCBBAcBaBBCbAaACCaCBcAAabbCABaCaBaCABcAcBbaaCcACbCaBbBCAaBABBabbBcbAbbaAababACbaacBBBcaabBbcBCCBBCccabBbBcBBaaBaBABbCACCbbBbAABACcAAbAcCcaCaAABcBbABbabCABcbbacBBBbBaCaBCACBaaCAbBBBbBBCcBbcBaccCbcCcCBcaBcabcccacCbbBAbaAaacCbaCCBacAaCABAABAbbCbcBCcabCbbabcbcABBCaAccAcbCBAcAABBABCcAcCbABbBBcBacaacCBBbacBcAbACBBAccCCbCBcABacACBaBCaCAAaAaAbccAcabcaBCbbAbAabBccbbCcbcBBCAbcBCBbbaBcaccACBBbBcACcaBcbcCABAAacccBcbCBaBBBACbaBbcAaAcbCaccbCaBabccCacCCCbbcaCaBcaabBAcBcAabAACbAbacbaCCcaBcCCBCCBaaAACAbcBbccAAbACBCcccAcbCbaAbCbAabCCCbACCCCAbACaAcBBaBcAcBBcCBcacBCcBacaaaBAbBAaCABbbBcabcABbAcbBbaCbBbccbBaCcBaabAAaAaBbCbAaBBabABCaCaCcBABccCcAACacAAcbbAABbbbAcBACAbBaabBcAbBacCbAaAccaCaCbBaAbAAaBAcBCBaBcbBaacaBbccaAcBaaBabAcAaccCbBcBaAACBCCCBCcCAbCAacbaCBcbaACBCAABccCbbBbaaaCBbABbCcAbCbcCaAaAcbABbbAAAAbBBCBaBAAaCAaCaCbbCCcBabBBbCaaCbBccAcaaACAbbbbCbaaCacCAcbacBACABbaabBaAbBBAcBbaBaBBcCbCbCAcacbBbCCAaBBCBaAacbBAbCCCaaAACacBbCBaCABAbAacbBbcBBAAbaaacAacAabCcCbaABBabAbcbBbcBbcCAACCCBBBAcabaaAbBbCBbAaCcABACaBBcabCACaCBCAaCabBCBbaaAbAaAbAAbBAcbCbcbcCcabcacaBbBCbAbbAcbCCAbcbCaaaaABAAbABCAbaacABcCCcCCCCBaCBcaBAaaABbCbCcBACAaCcaAacaaBACcBcbBcbCabBAbCbBbBCBbabCccACCbBbcAabAbacBBcBccBCACBbaccaaBAabcccCAAaacaabaabACbBaaABcCBbCBCBbAaAAabbbBCABCCcAcaaCbabaacCcbCbcaACCcBbbBBbBccaBBcabCBabCccABcABBcABbBAABBCBcCbaabacaCcbbBbaCbccbcAAcBAaBbabCCCACCAabBAaCAacBBacACBAbBBCaAAccAabAabBcCbbcAcaCacBAbAAacaAbCccbaACCCaABaACcbBcAbbBbbbaAaAbbbAacbAccacCbcccAcCBabAcAaCBAaccbccAbaBAaABbAAcBABBcCCBABBCaAbACcAaCcbbaaCBbbbABcaCbBBBCbbbcBABBbbCbabCaCaBBccBCCaAbBccAcCcBccccAaAaAcBcCBCBAcbcCBaBBbacCbBabACAabccBaabcCCCbbCAaabCBAAcccCaBbabcbbABaCACbbbcBBAbAabaBbCAccabcaaaAccCBBacbBbaCbAcBCCabBaacaABBbbaabbCBBaaBBbCbbBCacbAbcaccAAcCbCCBABCAAbaaBCabcaBbbBcAcbBaaAaCCAaABacbBBCBBcBcbCcAbcbbBaAbbcAcbbbaaAcBacAcbCccAAAAcCABAabBCCbCBAaBBCaaCccBbbcABcAcbcBBBabBAaaABBaCCaBCaaABBBCaBAcBbbAbBbBBcAAbbCCBbaBCACcCBcCccCccbAbbCCAAabcAAbaABAAAaBaABCbAAbCBBbbBabbbCbbbbCCBCABbBaacBABcabaBBABaABaBBcbcCbbccCCabcbCBcacCcAabAccbCBbBbcAcaAbAABcBbcbAABBbaaBbCaccbcaCcAbAABacCbcBAACabCCcAcbBBBbaBBCCACbCBBcACACaBbABAcCAcAbcbacABccACABBaAbBaCCaaABCBcAbBABBcCBAaaAaBACCBcBCaBAccaBaCBBAaCAAABAacbcAAcBcaabaCCbaCBAbabbbBbaacbcAbCAbaCAbBCBaBAAAaCCbcCcCaCbaCBABAcBAABbbaBCaBCaabcCcacABcAcBaBBBaAccBBbabbcaBbBAaacAcCAbCcBBCbcABCccbcccbBbAbBabABCCCbBACccacBbACbBCcBcCBBAacBAABabBABababBABAABCACCCBacbACBABccacCCbAbAbaBABAbCcACBBBAbCCbAacABBaCBCaCAaBcCAccbabBCAAbBBbCACbaCCBBBAABBBcCaacbACbbBBbBBBAcAAabBaABBAAacbbaBBCCaBBCcBBaBAabCABCcAAcCcAbAAAccacBACBCaAacaaacbacAbcCCbBABbAacACBbBbACCCcAaAAAAAbCcbBBabBbACbcABBBbbcabcBbBCbBcaCbCbcbABABcBbAaAacaaccCCaAcAcCBbbBbBAaBAbBcabaAbcBAACCabbCbABaAACCcaABbaAbcBBbaaACBcBacAaBccCCcAcbcbCbCCBBcCbAbcccBAaBcaCBCBACCcbBcCaCaCBaaCbaBCbcbCcbbAbbaBbcCBCcCACCccbbBCCAAcAACCCAcbCcBaBaCccABAcCCaCCBcbCBBCbcBAaCbBBbbABcBCCbaCCCBbcaacACbbCbabccBBCaCbAbAcacBbbCcBbBBAcbBcAbbCbcccAcAbCAcCCcBbCaCBAAAABAAaabaACCcaBAaabcbAABbCbBACbcbBBCbcACaccAaBCacaBbAAaaaACaCbBaacacAaBaacAcbbCaABBccBaABABCBaBcccACbABCBbaCaacbBaCbCaabAcaACcacaBABCbBbCAbcbaBbbCacCcAcCbcCBAAbccccABCaAcacAABAaAACAAAbBaaACcccaCACaACAAacAaBBbaabaBabCBbACBacbacAbCAACaBbacAaaCbBBCCABbBcbaBAbcaaaaaBCaAAACaBACcABaabacCbAbBCAcccabAbBcBACbbccacAABBAbBbbaCcAbaCaabAccACcCBaBccCcBaACaBBbBAcbCbaacbcAaCbbBCaABCAacCbcbBBbCaabcAacABbBAcBbCcBbaaBAABcBbBcbBbAcbAbCcBbaAbbBbaaCaABBCabBccCBaaaCccAcbccbBAAbccbcacaACCabBCABcbCbCCCccacbcCcccAAbBcBCAaaacCACBbCBaCABBCACacaBcbBCcBbAabCCBcCbbCaAcaaABBbCccBaCBBAACBbBcAbaBBAACcbbcbBBCAbAbbacCCBcaCCbacaBbcbbcBaccABCCbBCBcCaaAbAcbbcCCAABabaAbbbaABbAbbACcCAcaBcbAaACACaaAacBbcCbbbCbabCcaCcbcBAaBcBAcaACACaAacABaBcCaAcBAaaccaAAbBAbccCaACaABCbCCAbCBBcCccBaCCbBCbBBaaabCCCAccBaabACAbbacAAcAAbcbaCCbCaaBAacaAAcAACAbCCCaBcAAAbcaCAabAaaabBbBcCCAaAaBabbBcacbCBacACccccBcabbBABbCAaBcBbAcABaABbacAaccaCcaabbAcBccbaacccCAAAbcCBBCCCbBABccAacabbACACAcACccCaCCcccabacACbbcbbbBaccCbcCAACAABbbBaacCBaabbcbcaCcbaAbCaBACcbbaBaBccCabcCAbCaBcAAbaCCaAAcbCABcccCabbbBbcBAbbBcABBCbbcCaaCCbBBACbCcbCAcbaBCcCBCBbBCcAbbbBcacCcbBAccaBABaBCABBbBBcaAcCACbaBbaBcbCBBaCCBaababccCAAcbaaaCCBabbcBbCcbcbBaCBbbbcaCBACACCbaAaACBBabCbaACaBCABBbbBAbCACCBaAAaaaabcAbcaCbaBbbaCbCBAABCAaBbcbAbACCcaCbbCCcbBcBaccCAbABAacBbBccaaACAbbBabAbACBCAbCBabCCaaCcCaacCaaCcabcbacCbbcBACBcaaABaaaabbCCABcCcacBaccAACAACCCCCCbbCcccacbBBAaBcACbCabcbABabcaacBCccAaCAaaABBacAbacBbbABbBcaBbccbBCabAAabcCBACbaCCaACaabaAacCcbccBabbCCbAAbcCbbCBabbAAbBbAaCBAcabBBBaBbCCcbaabbcBaCcaacACcaAcaaaABABbbAAaaCCababACCaabBCAcbBAbCbBAbBBAcBCaBaacAABaABCCAbAACCbbcCCbCAACaacCBAaBaACbaBAbbCBcBcCBcBBbAAbaaccbaccACBCaaaaccCbAbcaBBaBCAcBCcaaBBABcbAaAaaaaBaCbAacaAACcAACCCbACBCbcACaacCBaCbAcbCbcBBacAaBCcACAcbaBabcCACacbaCBabACAbccCBaBBcBAABaaCcBcbacbBBCcaaAaaaBaAcaAbBcCbAccbCCCcCBBAaccCBaaCBbCbAcBCcbABAaacaBaCBBbAaCbACBbccBaABbCbccCBCcbAaBaBabcCcBbCcbBABAAaBAaCcBaaaabCbcCbCbcAABAcAcBaabCbccBCaCaBaACccaCbbaabBbCbccBCbAcaACabCCABababABaBCCacCBbBaACcCCAAcbbcBbbcccCbCAcbBbCaABCbBcbbACBbaccACbBCBCCaAbBcBBcCacbCcbbCCBaCBBBbcBCCCcACBbbbbACbACAaBCcBbaaAbCCccCbcbccbAAbCBcabCacBCacBCaaaaAaAbCbBcacbAbbacAaCcbACCbabBacAbCbbcabaCCcBCccaacCaCbCAaabaCcACaACABcCCbAbcCABBAabBAbCbBBABbbbbCcAaCCbBABBCbaaabCbababbBaCbbabbAABbCAbaaCbccaaaBAAcAabbcbBCAccBACbCabcBcBBbbcaCAABCCaCAbBCcABBbcAcbABcBAAcbbcBBAbCCaaaBBcCcbbACAaabBBcBbbAbAbccCcbbcbBabCBBaCaACACBaACacaAabCbBCaCABABccCcCaBCBABAcaBAcCCaAaACCcaBBBbbABbCBAcCbBbBAABbbabAcBBaaBcAbcabACACacCbaBACbaBcCcCCbCACcCBaAbBCBCbcbbbcAbcbaabbBcCaBaaBCbcaaCacbbAcCBcBBbCcBBcbaCabBbCCBbaBCcBAABcABaAcaaCCcCABbACACACcAaCBCcacCcbcCCCaabbBACbCbbcaaCabaBcBaBbBCbCCcCcacAccBaCAbCbbACccaCAbabaAcBBCaBabaACbcaCccbAbcCcbcabbAAaaBbaCCAAAbcAcABaaaBBABCBcBBAbbaccbbAbCbCCCAbcacccBBBCbACcaCcBCcABACCbBcbbCaacbbCaacBaCCaBAAaccCBbbaaabcAcABBAcaCbACaAaAacaCBBcabBCBAcCccBCCbbCbAcCBBabcCbCCcACCcCBcCCCaBaAbBCCCCBBABBbCBCabacaCaCcaBcAABabAcaCcbBCbbCBcBBcAABAaBAaCABcaCBbCabaAbcCBcaaBbaaAbBaCaAAABbacbbACbcaBCCBAccaBbbAacAacCAbACbaaaCBACbacBbAAaCcacbaAaBaCBabBcCAccBAACcCCBAaBbBAcABaCaCbBaaBaCCBBBBBAbBabaacAbCaccBBCBaBCACaABaBbaAAABAbaCACabcCCbABbcaBacacCBCBBBAacaccaCAbCaAcbCabbbccaABcAbcCcBCabCCBaBaacAbCbAaaBABAcBABCAbcccACACABcCaaaCbbAcCcBBbAacBaaAaBCcCBcbcbCbccCCCcAAaacbAaBBCAacCAaAbabaaABaCBBaBcbccAaBabCABABAcAAaCabBbAbABBbBCAcaabCcbaAbaAabCcAabaCabBAbCaCBaBaCbAccAaABAacCaBBccccCaBacbAaABcACCacbBcABbaBBCCabcAbcAACACBbBCBcABBcBBCAbcCcCCAAAcBabBcaCbcCBcCcAbAacCcBbbaCCAbaCbbccCAaABbaBCAccCBBbBcBcbCCACbAaBabABACCbcAcAacCaABCccbCcAcACcBaBBcaABbCbabAcBbbaAABBaBABaCacCbAAcaAbABcCCCaBCCCbcaAcCCaACBcacACCbBCCbcaAbccabABBbBcbbCAABAACabABcbAacbaAbaCBaBBbbAAABBacCcCcbabCCAabbbcCAcCaBCCBbcacABbbbaacAcBcccBbbBBabAcaaCcABbCAABBAcaacbaCACCcbCCaBABcBbBCAbCAACbAcCBccbCaACcCCCbAbAcbACbbCCCBACABcACcacaBcbaacBCccBaCcaBABABCaBaBaAcbAbCABBBbBCACCBbbBcbAccBAaBAacCBbcBbaAcCbCbAbccCaBbcbCAAAbaACCCcABABCabbBBAbAcBccabCAcAaABCcabbcCCBBbBCACbAaBcABacbCcACbACCacCbABBCCAacacbBCBaaCAacaBBCaBcAcCAcABbaCcbBCbAcBACcbABCbcBBcAAaCCBAbBbBbcCaABbAaBbaCaABabACBaabCcBBcCcCcaacaabCAacAbbbcCbaBaACcbCbACAaCBCbCbcBAABcCAAacAAbcbBAAbbBAA"""

def all_mentors(pattern, repeat, limit):
    assert limit < len(pattern)
    total = 0
    mentors = { 'A': [], 'B': [], 'C': [] }
    for idx, c in enumerate(pattern):
        if 'A' <= c <= 'C':
            mentors[c].append(idx)
    for idx, c in enumerate(pattern):
        if 'a' <= c <= 'c':
            mentor_char = chr(ord('A') + ord(c) - ord('a'))
            ments = mentors[mentor_char]
            for idx2 in ments:
                if idx < idx2 and idx2 - idx <= limit:
                    total += repeat
                if idx < idx2 + len(pattern) and idx2 + len(pattern) - idx <= limit:
                    total += (repeat - 1)
                if idx2 < idx and idx - idx2 <= limit:
                    total += repeat
                if idx2 < idx + len(pattern) and idx + len(pattern) - idx2 <= limit:
                    total += (repeat - 1)
                    
    return total

def main():
    print(f"All mentors (examples): {all_mentors('AABCBABCABCabcabcABCCBAACBCa', 2, 10)}")
    print(f"All mentors (actual): {all_mentors(mentors, 1000, 1000)}")
if __name__ == "__main__":
    main()